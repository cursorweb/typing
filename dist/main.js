(()=>{"use strict";var t=[{title:"Left Hand DV",desc:"Left Hand Only! (Dvorak Layout)",list:["a","o","e","u","'",",",".","p","y","i",";","q","j","k","1","2","3","4","5","6","`"],noSpace:!0},{title:"Right Hand DV",desc:"Right Hand Only! (Dvorak Layout)",list:["d","h","t","n","s","-","f","g","c","r","l","/","=","\\","x","b","m","w","v","z","7","8","9","0","[","]"],noSpace:!0},{title:"Spanish Accents",desc:"All spanish accents, including ü and ç",list:["á","é","í","ó","ú","Á","É","Ó","Í","Ú","ñ","Ñ","ç","Ç","ü","Ü"],noSpace:!0}],e={results:document.querySelector(".wpmresults-page"),typing:document.querySelector(".typing-page")};function n(t,e){t.style.display="none",e.style.display="block"}var o=document.querySelector(".wpmresults"),r=function(){function t(t){this.name=t,this.chars=0,this.correct=0,this.wrong=0}return t.prototype.begin=function(){this.start=new Date},t.prototype.end=function(){this.endTime=new Date},t.prototype.calcWpm=function(){var t=this.chars/5,e=this.chars-this.correct,n=(this.endTime.getTime()-this.start.getTime())/6e4;return Math.max(0,(t-e/5)/n)},t.prototype.calcAcc=function(){var t=this.chars;return 100*(1-this.wrong/t)},t}(),s=new(function(){function t(){var t=this;this.inputEl=document.querySelector(".user-input"),this.testCont=document.querySelector(".test-cont"),this.focusOverlay=document.querySelector(".overlay"),this.testTitle=document.querySelector(".test-title"),this.focusTynput(),document.addEventListener("keydown",this.focusTynput.bind(this)),this.testCont.addEventListener("click",this.focusTynput.bind(this)),this.focusOverlay.addEventListener("click",this.focusTynput.bind(this)),this.inputEl.addEventListener("focus",(function(){t.focusOverlay.style.display="none",t.tynputFocused=!0})),this.inputEl.addEventListener("blur",(function(){t.focusOverlay.style.display="flex",t.tynputFocused=!1})),this.inputEl.addEventListener("keydown",(function(e){if("Backspace"==e.key){if(0==t.cIdx)return;t.els[t.cIdx].classList.remove("curr","wrong","correct"),t.cIdx--,t.els[t.cIdx].classList.remove("wrong","correct"),t.els[t.cIdx].classList.add("curr")}})),this.inputEl.addEventListener("input",(function(){var e=t.inputEl.value.normalize();if(t.inputEl.value="",0==t.cIdx&&t.testResult.begin(),t.els[t.cIdx].classList.remove("curr"),t.text[t.cIdx]==e?(t.els[t.cIdx].classList.add("correct"),t.testResult.correct++):(t.els[t.cIdx].classList.add("wrong"),t.testResult.wrong++),t.testResult.chars++,t.cIdx++,t.cIdx>=t.els.length)return t.testResult.end(),void t.listener._endTest(t.testResult);t.els[t.cIdx].classList.add("curr")}))}return t.prototype.focusTynput=function(t){void 0===t&&(t=null),this.tynputFocused||(null==t||t.preventDefault(),this.inputEl.focus(),this.focusOverlay.style.display="none")},t.prototype.newTest=function(t,e,n){var o;this.clear(),this.testTitle.textContent=t,this.cIdx=0,this.text=e,this.listener=n,this.testResult=new r(t);var s=e.split("");this.els=[];for(var i=0,a=s;i<a.length;i++){var c=a[i],u=document.createElement("pre");u.textContent=c,u.classList.add("char")," "==c&&u.classList.add("space"),this.els.push(u)}this.els[0].classList.add("curr"),(o=this.testCont).append.apply(o,this.els)},t.prototype.clear=function(){this.cIdx=0,this.testResult=null,this.testCont.textContent=""},t}()),i=function(){function t(){}return t.prototype.newTest=function(t,e){s.newTest(t,e,this)},t.prototype._endTest=function(t){this.endFn(t)},t.prototype.onEnd=function(t){this.endFn=t},t}();function a(t){return t[Math.floor(Math.random()*t.length)]}var c,u=function(){function t(){this.listener=new i}return t.prototype.end=function(){s.clear()},t.prototype.genText=function(t,e,n){return void 0===n&&(n=50),function(t,e,n){void 0===n&&(n=!1);for(var o="",r=0;r<e-1;r++)o+=a(t)+(n?"":" ");return o+a(t)}(t,n,e)},t.prototype.createResultEl=function(t){var e=t.calcWpm(),n=t.calcAcc(),o=t.name,r=document.createElement("div");r.classList.add("wpmresult");var s=document.createElement("div");s.textContent=o;var i=document.createElement("div");i.textContent="WPM: "+e.toFixed(2);var a=document.createElement("div");return a.textContent="Acc: "+n.toFixed(2),r.append(s,i,a),r},t}(),l=(c=function(t,e){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},c(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(r){function s(s){var i=r.call(this)||this;return i.test=t[s],i.listener.onEnd((function(t){o.append(i.createResultEl(t)),n(e.typing,e.results)})),i}return l(s,r),s.prototype.begin=function(){var t=this.genText(this.test.list,this.test.noSpace);this.listener.newTest(this.test.title,t)},s}(u),d=["a","o","e","'",",",".","p","y","i",";","q","j","k","x","1","2","3","4","5","6","`"],f=["d","t","n","s","-","f","g","c","r","l","/","=","\\","x","b","m","w","v","z","7","8","9","0","[","]"],h=[{title:"Keyboard Jump U",desc:"Jump to another key and then jump back to U! (Dvorak Layout)",gen:function(t){for(var e="",n=d,o=0;o<t/2;o++)e+="u",e+=a(n);return e}},{title:"Keyboard Jump H",desc:"Jump to another key and then jump back to H! (Dvorak Layout)",gen:function(t){for(var e="",n=f,o=0;o<t/2;o++)e+="h",e+=a(n);return e}}],y=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(t){function r(r){var s=t.call(this)||this;return s.test=h[r],s.listener.onEnd((function(t){o.append(s.createResultEl(t)),n(e.typing,e.results)})),s}return y(r,t),r.prototype.begin=function(){var t=this.test.gen(50);this.listener.newTest(this.test.title,t)},r}(u),v=[{title:"English",desc:"Basic English Warmup.",tests:[{title:"Two-Letter Pairs",list:["th","ar","he","te","an","se","in","me","er","sa","nd","ne","re","wa","ed","ve","es","le","ou","no","to","ta","ha","al","en","de","ea","ot","st","so","nt","dt","on","ll","at","tt","hi","el","as","ro","it","ad","ng","di","is","ew","or","ra","et","ri","of","sh","ti"],noSpace:!1},{title:"Two-Letter Words",list:["of","to","in","it","is","be","as","at","so","we","he","by","or","on","do","if","me","my","up","an","go","no","us","am","hi","ex","ok"],noSpace:!1},{title:"Three-Letter Words",list:["and","fix","own","are","fly","odd","ape","fry","our","ace","for","pet","act","got","pat","ask","get","peg","arm","god","paw","age","gel","pup","ago","gas","pit","air","hat","put","ate","hit","pot","all","has","pop","but","had","pin","bye","how","rat","bad","her","rag","big","his","rub","bed","hen","row","bat","ink","rug","boy","ice","run","bus","ill","rap","bag","jab","ram","box","jug","sow","bit","jet","see","bee","jam","saw","buy","jar","set","bun","job","sit","cub","jog","sir","cat","kit","sat","car","key","sob","cut","lot","tap","cow","lit","tip","cry","let","top","cab","lay","tug","can","mat","tow","dad","man","toe","dab","mad","tan","dam","mug","ten","did","mix","two","dug","map","use","den","mum","van","dot","mud","vet","dip","mom","was","day","may","wet","ear","met","win","eye","net","won","eat","new","wig","end","nap","war","elf","now","why","egg","nod","who","far","way","fat","not","wow","few","nut","you","fan","oar","yes","fun","one","yak","fit","out","yet","fin","owl","zip","fox","old","zap","will","she","any","the"],noSpace:!1},{title:"Alphabet",list:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],noSpace:!0},{title:"Numbers",list:["1","2","3","4","5","6","7","8","9","0"],noSpace:!0},{title:"Special Characters",list:["~","`","!","@","#","$","%","^","&","*","(",")","_","+","-","=","{","}","[","]","<",">","|","\\",":",'"',";","'",",",".","/","?"],noSpace:!0}]}],w=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),g=function(t){function r(r){var s=t.call(this)||this;return s.warmup=v[r],s.warmupIndex=0,s.testResults=[],s.listener.onEnd((function(t){if(s.warmupIndex++,s.testResults.push(t),s.warmupIndex>=s.warmup.tests.length){for(var r=[],i=0,a=s.testResults;i<a.length;i++){var c=a[i];r.push(s.createResultEl(c))}return o.append.apply(o,r),void n(e.typing,e.results)}s.begin()})),s}return w(r,t),r.prototype.begin=function(){var t=this.warmup.tests[this.warmupIndex],e=this.genText(t.list,t.noSpace);this.listener.newTest(t.title,e)},r}(u),b=document.querySelector(".warmup>.selection"),x=document.querySelector(".tests>.selection"),E=null;function L(t,o){for(var r=[],i=function(i){var a=t[i],c=document.createElement("div");c.classList.add("select-mode");var u=document.createElement("div");u.classList.add("title"),u.textContent=a.title;var l=document.createElement("div");l.classList.add("desc"),l.textContent=a.desc,c.append(u,l),c.addEventListener("click",(function(){null==E||E.end(),n(e.results,e.typing),o(i),s.focusTynput(),E.begin()})),r.push(c)},a=0;a<t.length;a++)i(a);return r}b.append.apply(b,L(v,(function(t){E=new g(t)}))),x.append.apply(x,L(t,(function(t){E=new p(t)}))),x.append.apply(x,L(h,(function(t){E=new m(t)})));var T=document.querySelector(".shortcut-reset"),k=document.querySelector(".shortcut-exit");T.addEventListener("click",(function(){E.begin(),s.focusTynput()})),k.addEventListener("click",(function(){})),document.body.addEventListener("keydown",(function(t){"Tab"==t.key&&(t.preventDefault(),T.click())}))})();